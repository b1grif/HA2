####################################################
#                                                  #
#               HA 2 General Config                #
#                                                  #
####################################################
homeassistant:
  name: Home
  latitude: !secret lat_home
  longitude: !secret lon_home
  elevation: !secret elevation
  unit_system: imperial
  time_zone: !secret time_zone
  customize: !include_dir_merge_named customization

http:
  api_password: !secret http_password
  ssl_certificate: !secret ssl_path
  ssl_key: !secret ssl_key
  base_url: !secret http_url
  ip_ban_enabled: true
  login_attempts_threshold: 5

####################################################
#                                                  #
#               Components                         #
#                                                  #
####################################################

alarm_control_panel:
  platform: manual
  name: Alarm
  pending_time: 0
  trigger_time: 600
  disarm_after_trigger: false

camera:
  - platform: generic
    still_image_url: https://radblast.wunderground.com/cgi-bin/radar/WUNIDS_map?station=LOT&brand=wui&num=1&delay=15&type=N0R&frame=0&scale=1.000&noclutter=0&showstorms=0&mapx=400&mapy=240&centerx=400&centery=240&transx=0&transy=0&showlabels=1&severe=0&rainsnow=0&lightning=0&smooth=0&rand=24691024&lat=0&lon=0&label=you
    name: weather_radar

climate:
  - platform: nest

device_tracker:
  - platform: bluetooth_tracker
  - platform: nmap_tracker
    hosts: 192.168.0.1-80
    track_new_devices: yes
    home_interval: 10
  - platform: owntracks
    max_gps_accuracy: 100

ifttt:
  key: !secret ifttt_secret

media_player:
  - platform: cast
    host: 192.168.0.31
  - platform: webostv
    host: 192.168.0.36
    mac: A0-6F-AA-38-FE-1A
    name: Living Room TV
    customize:
      sources:
        - livetv
        - youtube
        - netflix
  - platform: plex
  - platform: sonos

mqtt:
  broker: 192.168.0.30
  port: 1883
  client_id: home-assistant-1
  keepalive: 60
  username: !secret mqtt_user
  password: !secret mqtt_password

nest:
  client_id: !secret nest_client_id
  client_secret: !secret nest_client_secret
  binary_sensors:
    monitored_conditions:
      - 'online'
      - 'fan'
      - 'is_using_emergency_heat'
      - 'is_locked'
      - 'has_leaf'

notify:
  - platform: html5
    name: HTML5
    gcm_api_key: !secret html5_server_key
    gcm_sender_id: !secret html5_sender_id
  - platform: webostv
    host: 192.168.0.36
    name: livingroom_tv


# Weather Prediction
sensor:
  - platform: darksky
    api_key: !secret dark_sky_api
    monitored_conditions:
      - summary
      - icon
      - nearest_storm_distance
      - nearest_storm_bearing
      - precip_type
      - precip_intensity
      - precip_probability
      - temperature
      - apparent_temperature
      - dew_point
      - wind_speed
      - wind_bearing
      - cloud_cover
      - humidity
      - pressure
      - visibility
      - ozone
      - minutely_summary
      - hourly_summary
      - daily_summary
      - temperature_max
      - temperature_min
      - apparent_temperature_max
      - apparent_temperature_min
      - precip_intensity_max
  - platform: template
    sensors:
      chromecast:
        value_template: "{{ 'Online' if is_state('device_tracker.chromecast', 'home') else 'Offline' }}"
  - platform: moon
  - platform: mqtt
    state_topic: 'owntracks/mosquitto/billsphone'
    name: 'Bills 6P Battery'
    unit_of_measurement: '%'
    value_template: '{{ value_json.batt }}'
  - platform: nest
    monitored_conditions:
      - temperature
      - target
      - humidity
      - operation_mode
      - hvac_state
      - battery_level
      - co_status
      - smoke_status
      - weather_temperature
      - weather_humidity
      - weather_condition
      - wind_speed
      - wind_direction
  - platform: speedtest
    monitored_conditions:
      - ping
      - download
      - upload
  - platform: command_line
    name: SSL Cert Expiry
    unit_of_measurement: days
    scan_interval: 86400
    command: "ssl-cert-check -c /etc/letsencrypt/live/griffithshome.duckdns.org/cert.pem | tail -c 38"
  - platform: systemmonitor
    resources:
      - type: disk_free
        arg: /home
      - type: memory_free
      - type: processor_use
      - type: last_boot
  - platform: time_date
    display_options:
      - "date_time"
  - platform: yr

# Track the sun
sun:

# Text to speech
tts:
  - platform: google
    cache: true
    cache_dir: /tmp/tts
    time_memory: 300

wemo:

zwave:
  usb_path: /dev/ttyACM0
#  config_path: /srv/homeassistant/src/python-openzwave/openzwave/config
#  device_config: !include zwave_device_config.yaml
  new_entity_ids: true


####################################################
#                                                  #
#                     Includes                     #
#                                                  #
####################################################
group: !include groups.yaml
automation: !include automations.yaml

# Single Files

logger: !include logger/logger.yaml
input_boolean: !include input_booleans.yaml
input_select: !include input_selects.yaml
shell_command: !include shell_commands.yaml
#zwave: !include zwave_device_config.yaml

# Merge List
# will return the content of a directory as a list
# with each file content being an entry in the list
alert: !include_dir_merge_list alert

# Dir List
switch: !include_dir_list switch
zone: !include_dir_list zones


####################################################
#                                                  #
#                     Enables                      #
#                                                  #
####################################################
# Enables configuration UI
config:
# Allows you to issue voice commands from the frontend in enabled browsers
conversation:
# Discover some devices automatically
discovery:
# Enables the frontend
frontend:
# Enables support for tracking state changes over time.
history:
# View all events in a logbook
logbook:
# Checks for available updates
# Note: This component will send some information about your system to
# the developers to assist with development of Home Assistant.
# For more information, please see:
# https://home-assistant.io/blog/2016/10/25/explaining-the-updater/
updater:
  include_used_components: true
recorder:
  purge_days: 3




